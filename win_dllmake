# toolchain name
ARCH=x86_64
OS=w64
TOOLS=mingw32
PREFIX=${ARCH}-${OS}-${TOOLS}
echo ${PREFIX}

# set compiler and compiler paths
CC=${PREFIX}-gcc
SYSROOT=/usr/${PREFIX}/sys-root/mingw/
INC=${SYSROOT}/inc/
LIB=${SYSROOT}/lib/
LIBS="-lftdi1 -lusb-1.0"

echo "compiling"
${CC} -c kcube_message.c -fPIC -Wall -Werror
${CC} -c kcube_server.c -I${INC} -pthread -fPIC -Wall -Werror

echo "linking"
${CC} -shared -o kcube.dll kcube_message.o kcube_server.o -L${LIB} ${LIBS} -pthread -fPIC -Wall -Werror

# old
#${CC} -shared -o libkcube.dll kcube_message.o kcube_server.o -L/usr/lib/ -lftdi1 -lusb -lwinpthread -pthread -fPIC -Wall -Werror
#${CC} -static -shared -o libkcube.dll kcube_message.o kcube_server.o -L/usr/lib/ -lftdi1 -lusb-1.0 -lwinpthread -pthread -fPIC -Wall -Werror
#${CC} -shared -o libkcube.dll kcube_message.o kcube_server.o -L/home/Neurophos_Design/lib -lftdi1 -lusb-1.0 -pthread -fPIC -Wall -Werror
#${CC} -static -shared -o libkcube.dll kcube_message.o kcube_server.o /usr/lib/libftdi1.a /usr/lib/libusb-1.0.a -pthread -fPIC -Wall -Werror
#${CC} -shared -o libkcube.dll kcube_message.o kcube_server.o /usr/lib/libftdi1.dll.a /usr/lib/libusb.dll.a -pthread -fPIC -Wall -Werror